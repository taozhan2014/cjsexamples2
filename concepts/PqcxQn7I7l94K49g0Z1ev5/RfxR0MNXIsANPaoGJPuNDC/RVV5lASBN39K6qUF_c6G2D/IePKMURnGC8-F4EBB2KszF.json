{
  "uri" : "local://IePKMURnGC8-F4EBB2KszF/",
  "name" : "Country View",
  "category" : ".view",
  "parent" : "local://RVV5lASBN39K6qUF_c6G2D/",
  "pname" : "Country",
  "flags" : "U",
  "lvars" : [ {
    "name" : "model",
    "type" : "local://RVV5lASBN39K6qUF_c6G2D/",
    "typeName" : "Country"
  } ],
  "vars" : [ {
    "name" : "htmlTemplate",
    "expr" : {
      "str" : "<head>\n  <script src=\"//cdnjs.cloudflare.com/ajax/libs/numeral.js/1.5.3/numeral.min.js\"></script>\n  <style>\n    a.panelHdr {\n      color: black;\n      font-weight: bold;\n      font-size: 1.2em;\n    }\n    #statsAccordion > .row {\n      margin-top: 1em;\n    }\n    .detailsDl > dt {\n      padding-top: 10px;\n    }\n    .refLinks {\n      list-style-type: none;\n      padding-top: 3em;\n    }\n    .refLinks li {\n      text-align :right;\n    }\n  </style>\n</head>\n<body>\n  <div class=\"container\">\n    <div class=\"row\">\n      <div class=\"col-xs-0 col-sm-1 col-md-1\"></div>\n      <div class=\"col-xs-4 col-sm-3 col-md-2\">\n        <figure style=\"text-align: center; padding-top: 1em\">\n          <img src=\"https://www.cia.gov/library/publications/the-world-factbook/graphics/flags/large/{{identifier}}-lgflag.gif\" alt=\"Flag of {{name}}\" width=\"100%\">\n        </figure>\n      </div>\n      <div class=\"col-xs-7 col-sm-7 col-md-5\" style=\"padding-left: 2em\">\n        <h1>{{name}}</h1>\n        <h3>{{optLongName}}</h3>\n      </div>\n      <div class=\"col-xs-8 col-sm-8 col-md-4\">\n        <ul class=\"refLinks\">\n          <li><a href=\"/viewlocal://5o29LSbcagBRKKhfstOVF0/\"><b>Visit World Map</b></a></li>\n          <li><a href=\"//www.cia.gov/library/publications/the-world-factbook/geos/{{identifier}}.html\" target=\"_blank\">CIA World Fact Book</a></li>\n          <li><a href=\"//en.wikipedia.org/wiki/{{wpPageName}}\" target=\"_blank\">Wikipedia page</a></li>\n          <li><a href=\"//www.wikidata.org/wiki/{{wikiDataQid}}\" target=\"_blank\">Wikidata entry</a></li>\n        </ul>\n      </div>\n    </div>\n\n    <br>\n\n    <div class=\"panel-group\" id=\"statsAccordion\" role=\"tablist\" aria-multiselectable=\"true\">\n      <!-- Population -->\n      <div class=\"row\">\n        <div class=\"panel panel-default\">\n          <div class=\"panel-heading\" id=\"societyHdg\">\n            <a data-toggle=\"collapse\" data-parent=\"#statsAccordion\" href=\"#societyBdy\" aria-expanded=\"true\" aria-controls=\"societyBdy\" class=\"panelHdr\">\n              Population\n            </a>\n          </div>\n\n          <div id=\"societyBdy\" class=\"panel-collapse collapse in\" role=\"tabpanel\" aria-labelledby=\"societyHdg\">\n            <div class=\"panel-body\">\n              <div class=\"row\">\n                <h3 style=\"text-align: center\"><span data-numeral=\"0,0.000a\">{{population}}</span> (<span data-numeral=\"0.000\">{{popPercentOfWorld}}</span>% of the world)</h3>\n              </div>\n              <div class=\"row\">\n                <div class=\"col-xs-12 col-sm-6\">\n                  <div id=\"ageStructure\" style=\"width: 80%; height: 300px;\"></div>\n                </div>\n                <div class=\"col-xs-12 col-sm-6\">\n                  <div id=\"popRates\" style=\"width: 80%; height: 300px;\"></div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Economy -->\n      <div class=\"row\">\n        <div class=\"panel panel-default\">\n          <div class=\"panel-heading\" id=\"economyHdg\">\n            <a data-toggle=\"collapse\" data-parent=\"#statsAccordion\" href=\"#economyBdy\" aria-expanded=\"true\" aria-controls=\"economyBdy\" class=\"panelHdr\">\n              Economy\n            </a>\n          </div>\n\n          <div id=\"economyBdy\" class=\"panel-collapse collapse in\" role=\"tabpanel\" aria-labelledby=\"economyHdg\">\n            <div class=\"panel-body\">\n              <div class=\"row\">\n                <div class=\"col-xs-12 col-sm-6\">\n                  <h3>GDP (per capita, PPP): <span data-numeral=\"$0,0\">{{gdpPerCapitaPpp}}</span></h3>\n                  <h3>GDP (exchange rate): <span data-numeral=\"$0,0a\">{{gdpExchangeRate}}</span></h3>\n                  <div id=\"povUnempRates\" style=\"width: 80%; height: 200px;\"></div>\n                </div>\n                <div class=\"col-xs-12 col-sm-6\">\n                  <div id=\"gdpBySector\" style=\"width: 80%; height: 400px;\"></div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Geography -->\n      <div class=\"row\">\n        <div class=\"panel panel-default\">\n          <div class=\"panel-heading\" id=\"geographyHdg\">\n            <a data-toggle=\"collapse\" data-parent=\"#statsAccordion\" href=\"#geographyBdy\" aria-expanded=\"true\" aria-controls=\"geographyBdy\" class=\"panelHdr\">\n              Geography\n            </a>\n          </div>\n\n          <div id=\"geographyBdy\" class=\"panel-collapse collapse in\" role=\"tabpanel\" aria-labelledby=\"geographyHdg\">\n            <div class=\"panel-body\">\n              <div class=\"row\">\n                <div class=\"col-xs-12 col-sm-6\">\n                  <figure style=\"text-align: center\">\n                    <figcaption><a href=\"//www.google.com/maps/place/{{optGooglePlaceName}}\" target=\"_blank\">Show in Google Maps</a></figcaption>\n                    <img class=\"img-responsive\" src=\"//www.cia.gov/library/publications/the-world-factbook/graphics/maps/{{identifier}}-map.gif\" alt=\"Map of {{name}}\">\n                  </figure>\n                </div>\n                <div class=\"col-xs-12 col-sm-6\">\n                  <dl class=\"detailsDl\">\n                    <dt>Location</dt>\n                    <dd>{{locationDesc}}</dd>\n\n                    <dt>Terrain</dt>\n                    <dd>{{terrainDesc}}</dd>\n\n                    <dt>Climate</dt>\n                    <dd>{{climateDesc}}</dd>\n\n                    <dt>Natural resources</dt>\n                    <dd>{{natResourcesDesc}}</dd>\n                  </dl>\n\n                  <dl class=\"dl-horizontal\">\n                    <dt>Area</dt>\n                    <dd><span data-numeral=\"0,0\">{{area}}</span> sq km</dd>\n\n                    <dt>Land boundaries</dt>\n                    <dd><span data-numeral=\"0,0\">{{boundaries}}</span> km</dd>\n\n                    <dt>Coastline</dt>\n                    <dd><span data-numeral=\"0,0\">{{coastline}}</span> km</dd>\n\n                    <dt>Elevation (lowest)</dt>\n                    <dd>{{elevationMinPlace}}, <span data-numeral=\"0,0\">{{elevationMin}}</span> m</dd>\n\n                    <dt>Elevation (highest)</dt>\n                    <dd>{{elevationMaxPlace}}, <span data-numeral=\"0,0\">{{elevationMax}}</span> m </dd>\n                  </dl> \n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <script src=\"//www.google.com/jsapi\"></script>\n  <script>\n    function drawAgeStructure() {\n      var data = google.visualization.arrayToDataTable([\n          ['Age', 'National', 'Global'],\n          ['0-14',  {{popPercent0_14}}, 25.79],\n          ['15-24',  {{popPercent15_24}}, 16.61],\n          ['25-54',  {{popPercent25_54}}, 40.78],\n          ['55-64',  {{popPercent55_64}}, 8.51],\n          ['65+', {{popPercent65_max}}, 8.32]\n        ]);\n\n        var options = {\n          title: 'Population Pyramid',\n          vAxis: {title: 'Percentage',  titleTextStyle: {color: 'black'}, minValue: 0, maxValue: 100},\n          legend: { position: 'bottom' }\n      };\n\n      var chart = new google.visualization.ColumnChart(document.getElementById('ageStructure'));\n\n      chart.draw(data, options);\n    }\n\n    function drawPopRates() {\n      var data = google.visualization.arrayToDataTable([\n          ['Rate', 'National', 'Global'],\n          ['Birth',  {{birthRate}}, 19.15],\n          ['Death',  {{deathRate}}, 7.89],\n          ['Migration',  {{migrationRate}}, 0]\n        ]);\n\n        var options = {\n          title: 'Birth, death and migration rates',\n          vAxis: {title: 'Per 1000',  titleTextStyle: {color: 'black'}},\n          legend: { position: 'bottom' }\n      };\n\n      var chart = new google.visualization.ColumnChart(document.getElementById('popRates'));\n\n      chart.draw(data, options);\n    }\n\n    function drawPovUnempRates() {\n      var data = google.visualization.arrayToDataTable([\n          ['Rate', 'National'],\n          ['Poverty', {{povertyRate}}],\n          ['Unemployment', {{unemploymentRate}}]\n        ]);\n\n        var options = {\n          title: 'Poverty and unemployment',\n          vAxis: {title: 'Percentage',  titleTextStyle: {color: 'black'}},\n          hAxis: {minValue: 0, maxValue: 100},\n          legend: {position: 'none' },\n          chartArea: {left: 100}\n\n      };\n\n      var chart = new google.visualization.BarChart(document.getElementById('povUnempRates'));\n\n      chart.draw(data, options);\n    }\n\n    function drawGdpBySector() {\n        var data = google.visualization.arrayToDataTable([\n          ['Sector', 'Percentage'],\n          ['Agriculture', {{gdpByAgriculture}}],\n          ['Industry', {{gdpByIndustry}}],\n          ['Services', {{gdpByServices}}]\n        ]);\n\n        var options = {\n          title: 'GDP composition by sector',\n          legend: {position: 'bottom' },\n      };\n\n      var chart = new google.visualization.PieChart(document.getElementById('gdpBySector'));\n\n      chart.draw(data, options);\n    }\n\n    function drawCharts() {\n      drawAgeStructure();\n      drawPopRates();\n      drawPovUnempRates();\n      drawGdpBySector();\n    }\n\n    google.load(\"visualization\", \"1\", {packages:[\"corechart\"]});\n    google.setOnLoadCallback(drawCharts);\n\n    $(function() {\n        // Format numbers\n        $('span[data-numeral]').text(function(index, text) { return numeral(text).format($(this).attr('data-numeral')) });\n    });\n  </script>\n</body>\n",
      "strEditMode" : "html"
    }
  }, {
    "name" : "propertyMap",
    "expr" : {
      "script" : "// Placeholder values for Mustache template\nvar propNames = ['identifier', 'flagUrl', 'name', 'longName', 'wpPageName', 'wikiDataQid', 'population', \n  'gdpExchangeRate', 'gdpPerCapitaPpp', 'flagUrl', 'wikiDataQid', 'locationDesc', 'terrainDesc',\n  'climateDesc', 'natResourcesDesc', 'elevationMinPlace', 'elevationMin', 'elevationMaxPlace', 'elevationMax',\n  'birthRate', 'deathRate', 'migrationRate', 'povertyRate', 'unemploymentRate', 'area', 'boundaries', 'coastline',\n  'gdpByAgriculture', 'gdpByIndustry', 'gdpByServices'];\nvar result = _.object(_.map(propNames , function(item) {\n   return [item, model.prop(item).val()]\n}));\n\n// Since Mustache is logic-less, we need to add some logic here\nresult['optLongName'] = result['longName'] ? '(' + result['longName'] + ')' : '';\n\nvar ageStructure = model.prop('ageStructure').val();\nif (ageStructure) {\n  result['popPercent0_14'] = ageStructure['0-14'];\n  result['popPercent15_24'] = ageStructure['15-24'];\n  result['popPercent25_54'] = ageStructure['25-54'];\n  result['popPercent55_64'] = ageStructure['55-64'];\n  result['popPercent65_max'] = ageStructure['65-max'];\n}\n\nresult['popPercentOfWorld'] = 100 * result['population'] / 7174611584;\nresult['optGooglePlaceName'] = result['googlePlaceName'] ? result['googlePlaceName'] : result['name'];\n\nreturn result;"
    }
  }, {
    "name" : "page",
    "expr" : {
      "concept" : "/common/core/Xfh2VQ4HSK9klqbqqR-eBB/",
      "conceptName" : "Mustache HTML Page",
      "bindings" : {
        "htmlTemplate" : "htmlTemplate",
        "propertyMap" : "propertyMap"
      }
    }
  } ],
  "isas" : [ {
    "var" : "page"
  } ],
  "isLambda" : true,
  "digest" : "pwgP2jzOgNFMLa/t3sSm+w=="
}